<% if @post.valid? %>
  <% publish_to @channel do %>
    $("#posts").prepend("<%= j render(@post) %>");
    $("#posts").animate({scrollTop:0}, 500);
    $(".new_post")[0].reset();
  <% end %>
<% else %>
  errorString = "The following errors occured:\n\n"
  <% @post.errors.full_messages.each do |msg| %>
    errorString += '<%= msg %>\n';
  <% end %>
  errorString += '\nPlease check and send again.';
  alert(errorString);
<% end %>
