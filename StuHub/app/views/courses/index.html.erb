<% provide(:title, 'All Courses') %>

<div class="row">
  <div class="col-xs-12" style="text-align: center">
    <h1>Course Browser</h1>
  </div>
</div>
<% if @institution.current_term.data_mode == 1 %>
<div class="row">
  <div class="form-group col-sm-6 col-sm-offset-3">
    <%= collection_select(:department, :name, @departments, :id, :name, (@department_select ? {prompt: "Departments", selected: @department_select} : {prompt: "Departments"}), (@departments.size == 0 ? {class: 'form-control department_select', disabled: 'disabled'} : {class: 'form-control department_select'})) %>
  </div>
</div>
<div class="row">
  <div class="col-xs-12">
    <div class="table-responsive">
      <table class="table table-striped table-hover" id="users">
        <thead>
          <tr style="text-align: center;">
            <th width="30%">Course</th>
            <th width="50%">Description</th>
            <th width="20%">Add to Schedule</th>
          </tr>
        </thead>

        <tbody id="course_list">
          <% @courses.each do |course| %>
            <tr>
              <td><%= link_to "#{course.department.name} #{course.number}", get_info_course_url(course) %></td>
              <td><%= link_to get_info_course_url(course) do %><%= course.name.blank? ? "[Click to add this Course to StuHub]" : course.name %><% end %></td>
              <% if current_user.memberOfCourse?(course) %>
                <td><%= link_to "Drop", course_membership_path(current_user.course_memberships.find_by(course_id: course.id)), method: "delete", class: "btn btn-danger btn-block", role: "button", data: { confirm: "Are you sure you want to drop this course?" } %></td>
              <% else %>
                <td><%= link_to "Add", course_memberships_path(user_id: current_user, course_id: course), method: "post", class: "btn btn-primary btn-block", role: "button" %></td>
              <% end %>
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>
  </div>
</div>
<% else %>
<div class="row" style="text-align: center;">
  <h4>Your Institution currently does not support courses on this system.</h4>
</div>
<% end %>
