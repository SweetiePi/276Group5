<% provide(:title, 'All Users') %>

<div class="row">
  <div class="col-xs-10 col-xs-offset-1" style="text-align: center">
    <h1>All Users</h1>
  </div>
</div>
<div class="row">
  <div class="col-xs-10 col-xs-offset-1" style="text-align: center">
    <%= will_paginate %><br>
    <%= page_entries_info @users %>
  </div>
</div>
<div class="row">
  <% if current_user.admin? %>
  <div class="col-md-10 col-md-offset-1">
  <% else %>
  <div class="col-sm-8 col-sm-offset-2">
  <% end %>
    <div class="table-responsive">
      <table class="table table-striped table-hover" id="users">
        <thead>
          <tr>
            <% if current_user.admin? %>
              <th width="5%"></th>
              <th width="24%">Name</th>
              <th width="25%">Email</th>
              <th width="8%">Role</th>
              <th width="7%">Activated</th>
              <th width="15%" colspan="1">Actions</th>
              <th width="15%" colspan="2">Administrative</th>
            <% else %>
              <th width="5%"></th>
              <th width="40%">Name</th>
              <th width="10%">Role</th>
              <th width="30%" colspan="1">Actions</th>
            <% end %>
          </tr>
        </thead>

        <tbody>
          <% if @userscount <= 0 %>
            <tr>
              <td colspan="4">No Users</td>
            </tr>
          <% else %>
            <% @users.each do |user| %>
              <tr>
                <% if current_user.admin? %>
                  <td><%= gravatar_for user, size: 50, class: 'img-rounded' %></td>
                  <td><%= link_to user.name, user %></td>
                  <td><%= user.email %></td>
                  <td><%= user.role_string %></td>
                  <td><%= user.activated? ? "Active" : "Pending" %></th>
                  <td><%# Need to insert some actions here? %>&nbsp;</td>
                  <td>
                    <%= link_to 'Edit', edit_user_path(user) if (current_user?(user) || current_user.more_powerful(true, user)) %>
                  </td>
                  <td>
                    <%= link_to "Delete", user, method: :delete, data: { confirm: "Are you sure you want to delete this user?" } if !current_user?(user) && current_user.more_powerful(true, user) %>
                  </td>
                <% else %>
                  <td><%= gravatar_for user, size: 50 %></td>
                  <td><%= link_to user.name, user %></td>
                  <td><%= user.role_string %></td>
                  <td><%# Need to insert some actions here? %>&nbsp;</td>
                <% end %>
              </tr>
            <% end %>
          <% end %>
        </tbody>
      </table>
    </div>
  </div>
</div>
<div class="row">
  <div class="col-xs-10 col-xs-offset-1" style="text-align: center">
    <%= will_paginate %>
  </div>
</div>
